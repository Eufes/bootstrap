
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	УстановитьИспользованиеСлужебныхРегламентныхЗаданий();
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// Управление регламентными заданиями

&НаСервере
Процедура УстановитьИспользованиеСлужебныхРегламентныхЗаданий()
	
	ИмяТекущейИБ = ПолучитьПредставлениеИнформационнойБазыНаСервере();
	ИмяИБДляПроверки = НаборКонстант.QIWI_АдаптерИмяИБДляРаботыРеглЗаданий; 	
	МассивИменДляПроверки = СтрРазделить(ИмяИБДляПроверки, ";", Ложь);
	
	Если ЗначениеЗаполнено(ИмяИБДляПроверки) И МассивИменДляПроверки.Найти(ИмяТекущейИБ) <> Неопределено Тогда
		ИспользоватьСлужебныеРегламентныеЗадания = Истина;
	Иначе
		ИспользоватьСлужебныеРегламентныеЗадания = Ложь;
	КонецЕсли;	
	 
КонецПроцедуры

&НаКлиенте
Процедура ИспользоватьСлужебныеРегламентныеЗаданияПриИзменении(Элемент)
	
	Если ИспользоватьСлужебныеРегламентныеЗадания Тогда
		НаборКонстант.QIWI_АдаптерИмяИБДляРаботыРеглЗаданий = ПолучитьПредставлениеИнформационнойБазыНаСервере();
	Иначе
		НаборКонстант.QIWI_АдаптерИмяИБДляРаботыРеглЗаданий = "";
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Функция ПолучитьПредставлениеИнформационнойБазыНаСервере()	
	Возврат QIWI_АдаптерОбщегоНазначения.ПолучитьПредставлениеИнформационнойБазы();
КонецФункции